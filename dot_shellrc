is_bash=false
is_zsh=false
if [ -n "$ZSH_VERSION" ]; then
    is_zsh=true
elif [ -n "$BASH_VERSION" ]; then
    is_bash=true
fi

# ============================================================================
# EDITOR
# ============================================================================

export EDITOR='vim'

# ============================================================================
# COLORS
# ============================================================================

export CLICOLOR=1
export LSCOLORS=Gxfxcxdxbxegedabagacad

# ============================================================================
# HISTORY
# ============================================================================

export HISTSIZE=10000
export SAVEHIST=10000

$is_zsh && {
    setopt APPEND_HISTORY
    setopt HIST_IGNORE_DUPS
    setopt HIST_FIND_NO_DUPS
    setopt HIST_IGNORE_ALL_DUPS
    setopt HIST_SAVE_NO_DUPS
    setopt SHARE_HISTORY
}

$is_bash && {
    export HISTFILESIZE=20000
    export HISTCONTROL=ignoredups:erasedups
    shopt -s histappend
}

# ============================================================================
# COMPLETION
# ============================================================================

$is_zsh && {
    autoload -Uz compinit && compinit
}

$is_bash && {
    [ -f /etc/bash_completion ] && . /etc/bash_completion
    [ -f /usr/local/etc/bash_completion ] && . /usr/local/etc/bash_completion
}

# ============================================================================
# PROMPT
# ============================================================================

get_git_branch() {
    git symbolic-ref --short HEAD 2>/dev/null || git rev-parse --short HEAD 2>/dev/null
}

_prompt_command() {
    local branch
    branch=$(get_git_branch)
    if [ -n "$branch" ]; then
        PS1="\[\033[36m\]$(pwd | sed "s|$HOME|~|")\[\033[0m\] \[\033[33m\]($branch)\[\033[0m\] \$ "
    else
        PS1="\[\033[36m\]$(pwd | sed "s|$HOME|~|")\[\033[0m\] \$ "
    fi
}

$is_zsh && {
    setopt PROMPT_SUBST
    PROMPT='%F{cyan}$(pwd | sed "s|$HOME|~|")%f$([ -n "$(get_git_branch)" ] && echo " %F{yellow}($(get_git_branch))%f") %# '
}

$is_bash && {
    PROMPT_COMMAND=_prompt_command
}

# ============================================================================
# DIRENV
# ============================================================================

if command -v direnv >/dev/null 2>&1; then
    $is_zsh && {
        eval "$(direnv hook zsh)"
    }
    $is_bash && {
        eval "$(direnv hook bash)"
    }
fi

# ============================================================================
# ALIASES
# ============================================================================

alias g='git'

alias yoloclaude='claude --dangerously-skip-permissions'
